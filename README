This patched version of sFlow.pm handle missing Gateway data from flows.
It recreates these data, for globally routable addresses, using the raw sample.
It also uses the RIPE to map IP to ASN.

Known bugs (also called "features"):
- the cache is never cleaned up. You may want to manually run tools/fetch_ip_asn.py && reload your process to read the newer tools/ip2asn.json.


Q: Why on earth would I need that, btw ?
A: Well, I simply want to use that awesome code, to make beautiful graphs and seed what happen on my network : https://github.com/manuelkasper/AS-Stats. It is convenient, in my case, to use sFlow generated by switchs, not routers, meaning the do not carry any L3 information. Thus, this patched version.

See original README below.

sFlow 0.12

  A module to decode sFlow datagrams version 2, 3, 4 and 5. 

  sFlow is an industry standard technology for monitoring high speed 
  switched or routed networks. The technology is built into network 
  equipment and gives complete visibility into network activity, 
  enabling effective management and control of network resources.

  You can find more about sFlow on sflow.org. The datastructure of sFlow 
  v.4 is described in RFC 3176 (http://www.ietf.org/rfc/rfc3176.txt) and 
  sFlow v.5 in a memo on sflow.org (http://sflow.org/sflow_version_5.txt). 


AUTHOR

  Elisa Jasinska <elisa@jasinska.de>


CONTACT

  Please send comments/bugs to <elisa@jasinska.de> and/or <sflow@ams-ix.net>


COPYRIGHT

  Copyright (c) 2006 - 2015 AMS-IX B.V.

  This package is free software and is provided "as is" without 
  express or implied warranty.  It may be used, redistributed and/or 
  modified under the terms of the Perl Artistic License (see
  http://www.perl.com/perl/misc/Artistic.html)

